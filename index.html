<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tierlist Supers</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --accent: #4d79ff;
      --bg-dark: #121212;
      --bg-darker: #0a0a0a;
      --text: #f5f5f5;
      --tier-100: #4CAF50;
      --tier-75: #8BC34A;
      --tier-50: #FFC107;
      --tier-25: #FF9800;
      --tier-0: #F44336;
      --modal-bg: rgba(0, 0, 0, 0.8);
      --modal-content: #1e1e1e;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-dark);
      color: var(--text);
      overflow-x: hidden;
      min-height: 100vh;
      touch-action: none; /* Importante para evitar conflitos com touch */
    }
    h1 {
      text-align: center;
      color: white;
      margin-bottom: 30px;
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }
    .tier-container {
      max-width: 1000px;
      margin: 20px auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .tier {
      background: var(--bg-darker);
      border-radius: 12px;
      border-left: 6px solid;
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      transition: all 0.3s ease;
      position: relative;
      overflow-x: auto;
    }
    .tier[data-tier="100"] { border-color: var(--tier-100); }
    .tier[data-tier="75"] { border-color: var(--tier-75); }
    .tier[data-tier="50"] { border-color: var(--tier-50); }
    .tier[data-tier="25"] { border-color: var(--tier-25); }
    .tier[data-tier="0"] { border-color: var(--tier-0); }
    .tier-label {
      font-weight: bold;
      font-size: 1.1rem;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .tier-content {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 15px;
      min-height: 120px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 10px;
      transition: all 0.3s;
    }
    .character-container {
      position: relative;
      width: 100px;
      text-align: center;
      pointer-events: auto;
      user-select: none;
      transition: transform 0.3s ease;
    }
    .character-container:hover {
      transform: translateY(-5px);
    }
    .character {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #333;
      box-shadow: 0 4px 8px rgba(0,0,0,0.5);
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: grab;
    }
    .character:active {
      cursor: grabbing;
    }
    .character.dragging {
      transform: scale(1.2);
      opacity: 0.8;
      z-index: 1000;
      position: fixed; /* Alterado para fixed para evitar problemas de posicionamento */
      pointer-events: none;
      box-shadow: 0 8px 16px rgba(0,0,0,0.7);
      animation: pulse 0.8s infinite alternate;
    }
    @keyframes pulse {
      from { box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
      to { box-shadow: 0 0 20px rgba(255, 255, 255, 0.8); }
    }
    .character-name {
      font-size: 0.8rem;
      color: white;
      margin-top: 5px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .character-pool {
      max-width: 1000px;
      margin: 40px auto 0 auto;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      padding-bottom: 10px;
      justify-content: center;
    }
    .delete-btn {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ff4d4d;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      color: white;
      font-size: 12px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.3s, transform 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }
    .character-container:hover .delete-btn {
      opacity: 1;
    }
    .delete-btn:hover {
      transform: scale(1.2);
      background: #ff1a1a;
    }
    .controls {
      max-width: 1000px;
      margin: 20px auto;
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    .btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }
    .btn:hover {
      background: #3a5fcc;
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    .btn i {
      font-size: 1.2rem;
    }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--modal-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    .modal.active {
      opacity: 1;
      pointer-events: all;
    }
    .modal-content {
      background: var(--modal-content);
      border-radius: 12px;
      padding: 25px;
      width: 90%;
      max-width: 500px;
      transform: translateY(20px);
      transition: transform 0.3s;
    }
    .modal.active .modal-content {
      transform: translateY(0);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .modal-title {
      font-size: 1.5rem;
      margin: 0;
    }
    .close-modal {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }
    input[type="text"],
    input[type="file"] {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #333;
      background: rgba(255,255,255,0.05);
      color: var(--text);
    }
    .preview-container {
      margin: 15px 0;
      text-align: center;
    }
    #image-preview {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px dashed var(--accent);
      background: rgba(255,255,255,0.05);
      display: none;
    }
    .submit-btn {
      background: var(--tier-100);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      width: 100%;
      transition: background 0.3s;
    }
    .submit-btn:hover {
      background: #3d8b40;
    }
    .empty-message {
      color: rgba(255,255,255,0.4);
      font-style: italic;
      text-align: center;
      width: 100%;
      padding: 20px;
    }
    @media (max-width: 768px) {
      .tier-content {
        min-height: 100px;
      }
      .character, .character-container {
        width: 80px;
        height: 80px;
      }
      .character-name {
        font-size: 0.7rem;
      }
    }
    .drop-target {
      animation: highlight 0.5s;
    }
    @keyframes highlight {
      0% { background: rgba(77, 121, 255, 0.1); }
      100% { background: rgba(255,255,255,0.05); }
    }
  </style>
</head>
<body>
  <h1><i class="fas fa-layer-group"></i> Tierlist Supers</h1>
  
  <div class="controls">
    <button class="btn" id="add-character-btn">
      <i class="fas fa-plus-circle"></i> Adicionar Personagem
    </button>
    <button class="btn" id="reset-btn">
      <i class="fas fa-redo-alt"></i> Resetar Tierlist
    </button>
  </div>
  
  <div class="tier-container">
    <div class="tier" data-tier="100">
      <div class="tier-label">
        <span>100% TOP TIER</span>
        <i class="fas fa-crown" style="color: var(--tier-100);"></i>
      </div>
      <div class="tier-content" data-drop="100"></div>
    </div>
    <div class="tier" data-tier="75">
      <div class="tier-label">
        <span>75% EXCELENTE</span>
        <i class="fas fa-star" style="color: var(--tier-75);"></i>
      </div>
      <div class="tier-content" data-drop="75"></div>
    </div>
    <div class="tier" data-tier="50">
      <div class="tier-label">
        <span>50% MÉDIO</span>
        <i class="fas fa-exchange-alt" style="color: var(--tier-50);"></i>
      </div>
      <div class="tier-content" data-drop="50"></div>
    </div>
    <div class="tier" data-tier="25">
      <div class="tier-label">
        <span>25% FRACO</span>
        <i class="fas fa-exclamation-triangle" style="color: var(--tier-25);"></i>
      </div>
      <div class="tier-content" data-drop="25"></div>
    </div>
    <div class="tier" data-tier="0">
      <div class="tier-label">
        <span>0% LIXO</span>
        <i class="fas fa-skull" style="color: var(--tier-0);"></i>
      </div>
      <div class="tier-content" data-drop="0"></div>
    </div>
  </div>
  
  <div class="character-pool" id="character-pool">
    <!-- Personagens serão adicionados aqui via JavaScript -->
  </div>
  
  <!-- Modal para adicionar personagem -->
  <div class="modal" id="add-character-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Adicionar Novo Personagem</h3>
        <button class="close-modal" id="close-modal">&times;</button>
      </div>
      <form id="character-form">
        <div class="form-group">
          <label for="character-name">Nome do Personagem</label>
          <input type="text" id="character-name" placeholder="Ex: Homem-Aranha" required>
        </div>
        <div class="form-group">
          <label for="character-img">Foto do Personagem</label>
          <input type="file" id="character-img" accept="image/*" required>
        </div>
        <div class="preview-container">
          <img id="image-preview" alt="Pré-visualização da imagem">
        </div>
        <button type="submit" class="submit-btn">Adicionar Personagem</button>
      </form>
    </div>
  </div>
  
  <script>
    // Dados iniciais dos personagens
    const characters = [
      { name: "Stormicide", img: "https://files.fm/thumb_show.php?i=zwngz3ft4b" },
      { name: "Homem-Trovão", img: "https://files.fm/thumb_show.php?i=abfphs3p5z" },
      { name: "Homem-Universal", img: "https://files.fm/thumb_show.php?i=dqpwkzcfqj" },
      { name: "Hiper-Choque", img: "https://files.fm/thumb_show.php?i=dqvaxa497d" },
      { name: "Stratogata", img: "https://files.fm/thumb_show.php?i=65x4cg5n3g" },
      { name: "Everseer", img: "https://files.fm/thumb_show.php?i=3xvfmster6" },
      { name: "Downburst", img: "https://files.fm/thumb_show.php?i=5hwsb3s6gc" },
      { name: "Macroburst", img: "https://files.fm/thumb_show.php?i=kt4tev82ye" },
      { name: "Phylange", img: "https://files.fm/thumb_show.php?i=jgyzr35gcy" },
      { name: "Blazestone", img: "https://files.fm/thumb_show.php?i=q5k6j3z97y" },
      { name: "Apogee", img: "https://files.fm/thumb_show.php?i=gvff2n7zhy" },
      { name: "Raio de plasma", img: "https://files.fm/thumb_show.php?i=gekhuaawdt" },
      { name: "Gamma Jack", img: "https://files.fm/thumb_show.php?i=cx98qnume2" },
      { name: "Slashdown", img: "https://files.fm/thumb_show.php?i=qu2du34c54" },
      { name: "Dinamite", img: "https://files.fm/thumb_show.php?i=pz9nuj69as" },
      { name: "Metaman", img: "https://files.fm/thumb_show.php?i=fvyhnyb5pk" },
      { name: "Sindrome", img: "https://files.fm/thumb_show.php?i=6m3hrx9jvc" },
      { name: "Elastic Girl", img: "https://files.fm/thumb_show.php?i=rtr7t5qy8f" },
      { name: "Dash", img: "https://files.fm/thumb_show.php?i=6sejc23vrh" },
      { name: "Gelado", img: "https://files.fm/thumb_show.php?i=6egfn2qkf4" },
      { name: "Escavador", img: "https://files.fm/thumb_show.php?i=fjkceza7pw" },
      { name: "Violeta", img: "https://files.fm/thumb_show.php?i=v5wf5zfq6g" },
      { name: "Void", img: "https://files.fm/thumb_show.php?i=m7p5rfuyp4" },
      { name: "Gazer Beam", img: "https://files.fm/thumb_show.php?i=86myz6uxsd" }
    ];

    // Elementos DOM
    const pool = document.getElementById('character-pool');
    const modal = document.getElementById('add-character-modal');
    const closeModalBtn = document.getElementById('close-modal');
    const addCharacterBtn = document.getElementById('add-character-btn');
    const characterForm = document.getElementById('character-form');
    const characterImgInput = document.getElementById('character-img');
    const imagePreview = document.getElementById('image-preview');
    const resetBtn = document.getElementById('reset-btn');

    // Estado da aplicação
    let dragged = null;
    let currentCharacter = null;
    let customCharacters = JSON.parse(localStorage.getItem('customCharacters')) || [];
    let isDragging = false;

    // Inicializar a tierlist
    function initTierlist() {
      renderCharacters();
      
      // Event listeners para modais
      addCharacterBtn.addEventListener('click', () => {
        modal.classList.add('active');
      });
      
      closeModalBtn.addEventListener('click', () => {
        modal.classList.remove('active');
        characterForm.reset();
        imagePreview.style.display = 'none';
      });
      
      // Preview da imagem
      characterImgInput.addEventListener('change', function(e) {
        if (this.files && this.files[0]) {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            imagePreview.src = e.target.result;
            imagePreview.style.display = 'block';
          }
          
          reader.readAsDataURL(this.files[0]);
        }
      });
      
      // Adicionar novo personagem
      characterForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('character-name').value;
        const file = characterImgInput.files[0];
        
        if (!name || !file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
          const newCharacter = {
            name: name,
            img: e.target.result,
            custom: true
          };
          
          customCharacters.push(newCharacter);
          localStorage.setItem('customCharacters', JSON.stringify(customCharacters));
          
          createCharacterElement(newCharacter, true);
          
          modal.classList.remove('active');
          characterForm.reset();
          imagePreview.style.display = 'none';
        };
        
        reader.readAsDataURL(file);
      });
      
      // Resetar tierlist
      resetBtn.addEventListener('click', function() {
        if (confirm('Tem certeza que deseja resetar a tierlist? Todos os personagens voltarão para o pool.')) {
          document.querySelectorAll('.tier-content').forEach(tier => {
            tier.innerHTML = '';
          });
          
          renderCharacters();
        }
      });
    }
    
    // Renderizar todos os personagens
    function renderCharacters() {
      pool.innerHTML = '';
      
      // Adicionar personagens padrão
      characters.forEach(c => createCharacterElement(c));
      
      // Adicionar personagens customizados
      customCharacters.forEach(c => createCharacterElement(c, true));
      
      // Adicionar mensagem se não houver personagens
      if (characters.length + customCharacters.length === 0) {
        pool.innerHTML = '<div class="empty-message">Adicione personagens usando o botão acima</div>';
      }
    }
    
    // Criar elemento de personagem
    function createCharacterElement(character, isCustom = false) {
      const wrapper = document.createElement('div');
      wrapper.className = 'character-container';
      wrapper.dataset.name = character.name;
      
      const img = document.createElement('img');
      img.src = character.img;
      img.className = 'character';
      img.alt = character.name;
      img.draggable = false;
      
      const label = document.createElement('div');
      label.className = 'character-name';
      label.textContent = character.name;
      
      // Botão de deletar para personagens customizados
      if (isCustom) {
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'delete-btn';
        deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
        deleteBtn.title = 'Remover personagem';
        
        deleteBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          if (confirm(`Remover ${character.name} permanentemente?`)) {
            // Remover do array de customCharacters
            customCharacters = customCharacters.filter(c => c.img !== character.img);
            localStorage.setItem('customCharacters', JSON.stringify(customCharacters));
            
            // Remover do DOM
            wrapper.remove();
            
            // Remover de qualquer tier
            document.querySelectorAll('.tier-content').forEach(tier => {
              const charInTier = tier.querySelector(`.character-container[data-name="${character.name}"]`);
              if (charInTier) charInTier.remove();
            });
          }
        });
        
        wrapper.appendChild(deleteBtn);
      }
      
      // Adicionar funcionalidade de arrastar
      setupDragEvents(wrapper, img);
      
      wrapper.appendChild(img);
      wrapper.appendChild(label);
      pool.appendChild(wrapper);
    }
    
    // Configurar eventos de arrastar (mouse e touch)
    function setupDragEvents(wrapper, img) {
      // Eventos de mouse
      img.addEventListener('mousedown', startDrag);
      wrapper.addEventListener('mousedown', startDrag);
      
      // Eventos de touch
      img.addEventListener('touchstart', startDragTouch, { passive: false });
      wrapper.addEventListener('touchstart', startDragTouch, { passive: false });
    }
    
    // Iniciar arrasto com mouse
    function startDrag(e) {
      if (e.button !== 0 || isDragging) return; // Apenas botão esquerdo e evitar múltiplos arrastos
      e.preventDefault();
      
      currentCharacter = this.closest('.character-container');
      if (!currentCharacter) return;
      
      isDragging = true;
      createDragElement(currentCharacter.cloneNode(true), e.clientX, e.clientY);
      
      document.addEventListener('mousemove', dragElement);
      document.addEventListener('mouseup', endDrag);
      document.addEventListener('mouseleave', endDrag);
    }
    
    // Iniciar arrasto com touch
    function startDragTouch(e) {
      if (isDragging) return;
      e.preventDefault();
      
      currentCharacter = this.closest('.character-container');
      if (!currentCharacter) return;
      
      const touch = e.touches[0];
      isDragging = true;
      createDragElement(currentCharacter.cloneNode(true), touch.clientX, touch.clientY);
      
      document.addEventListener('touchmove', dragElementTouch, { passive: false });
      document.addEventListener('touchend', endDrag);
    }
    
    // Criar elemento de arrasto
    function createDragElement(clone, x, y) {
      dragged = clone;
      dragged.style.position = 'fixed'; // Usando fixed para evitar problemas de posicionamento
      dragged.style.left = (x - 50) + 'px';
      dragged.style.top = (y - 50) + 'px';
      dragged.style.zIndex = '9999';
      dragged.style.pointerEvents = 'none';
      dragged.querySelector('img').classList.add('dragging');
      
      document.body.appendChild(dragged);
    }
    
    // Arrastar elemento com mouse
    function dragElement(e) {
      if (!dragged) return;
      
      dragged.style.left = (e.clientX - 50) + 'px';
      dragged.style.top = (e.clientY - 50) + 'px';
      
      highlightDropTargets(e.clientX, e.clientY);
    }
    
    // Arrastar elemento com touch
    function dragElementTouch(e) {
      if (!dragged) return;
      const touch = e.touches[0];
      
      dragged.style.left = (touch.clientX - 50) + 'px';
      dragged.style.top = (touch.clientY - 50) + 'px';
      
      highlightDropTargets(touch.clientX, touch.clientY);
    }
    
    // Destacar áreas de drop possíveis
    function highlightDropTargets(x, y) {
      document.querySelectorAll('[data-drop]').forEach(drop => {
        const rect = drop.getBoundingClientRect();
        if (x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
          drop.classList.add('drop-target');
        } else {
          drop.classList.remove('drop-target');
        }
      });
    }
    
    // Finalizar o arrasto (comum para mouse e touch)
    function endDrag(e) {
      if (!dragged || !isDragging) return;
      
      let clientX, clientY;
      
      if (e.type === 'touchend') {
        if (e.changedTouches && e.changedTouches[0]) {
          clientX = e.changedTouches[0].clientX;
          clientY = e.changedTouches[0].clientY;
        }
      } else {
        clientX = e.clientX;
        clientY = e.clientY;
      }
      
      // Verificar se soltou em uma área de drop válida
      let dropped = false;
      document.querySelectorAll('[data-drop]').forEach(drop => {
        const rect = drop.getBoundingClientRect();
        if (clientX >= rect.left && clientX <= rect.right && 
            clientY >= rect.top && clientY <= rect.bottom) {
          
          // Remover a instância anterior se existir
          const existing = drop.querySelector(`.character-container[data-name="${currentCharacter.dataset.name}"]`);
          if (existing) existing.remove();
          
          // Adicionar novo elemento
          const newWrapper = currentCharacter.cloneNode(true);
          setupDragEvents(newWrapper, newWrapper.querySelector('img'));
          drop.appendChild(newWrapper);
          dropped = true;
          
          // Animação de entrada
          newWrapper.style.opacity = '0';
          newWrapper.style.transform = 'scale(0.8)';
          setTimeout(() => {
            newWrapper.style.transition = 'opacity 0.3s, transform 0.3s';
            newWrapper.style.opacity = '1';
            newWrapper.style.transform = 'scale(1)';
          }, 10);
        }
        
        drop.classList.remove('drop-target');
      });
      
      // Remover do pool se foi movido para uma tier
      if (dropped && pool.contains(currentCharacter)) {
        currentCharacter.remove();
      }
      
      // Limpar estado de arrasto
      cleanupDrag();
    }
    
    // Limpar estado de arrasto
    function cleanupDrag() {
      // Remover todos os event listeners
      document.removeEventListener('mousemove', dragElement);
      document.removeEventListener('touchmove', dragElementTouch);
      document.removeEventListener('mouseup', endDrag);
      document.removeEventListener('touchend', endDrag);
      document.removeEventListener('mouseleave', endDrag);
      
      // Remover elemento arrastado
      if (dragged) {
        dragged.remove();
        dragged = null;
      }
      
      // Resetar estado
      currentCharacter = null;
      isDragging = false;
      
      // Remover highlights
      document.querySelectorAll('.drop-target').forEach(el => {
        el.classList.remove('drop-target');
      });
    }
    
    // Iniciar a aplicação
    initTierlist();
  </script>
</body>
</html>
